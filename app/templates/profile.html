{% extends "base.html" %}
{% set active_page = "profile" %}

{% block body %}

<h1 class="title">Welcome, {{ name }} <svg xmlns="http://www.w3.org/2000/svg" width="50" height="40" fill="currentColor" class="bi bi-cloud-moon-fill" viewBox="0 0 16 16">
  <path d="M11.473 11a4.5 4.5 0 0 0-8.72-.99A3 3 0 0 0 3 16h8.5a2.5 2.5 0 0 0 0-5z"/>
  <path d="M11.286 1.778a.5.5 0 0 0-.565-.755 4.595 4.595 0 0 0-3.18 5.003 5.5 5.5 0 0 1 1.055.209A3.6 3.6 0 0 1 9.83 2.617a4.593 4.593 0 0 0 4.31 5.744 3.58 3.58 0 0 1-2.241.634q.244.477.394 1a4.59 4.59 0 0 0 3.624-2.04.5.5 0 0 0-.565-.755 3.593 3.593 0 0 1-4.065-5.422z"/>
</svg> </h1>

<div class="profile-container">
  <img src="{{ current_user.profile_picture_url }}" alt="Profile Picture" class="profile-img">
  
  <div class="profile-info">
      <p><strong>Name:</strong> {{ name }}</p>
      <p><strong>Email:</strong> {{ current_user.email }}</p>
  </div>

  <form action="/profile/upload_picture" method="POST" enctype="multipart/form-data">
      <label for="profile_picture" class="btn btn-primary upload-btn">Upload Profile Picture</label>
      <input type="file" id="profile_picture" name="profile_picture" style="display: none;">
  </form>

  <!-- Edit Name Button -->
  <button id="editNameBtn" class="upload-btn" style="margin-top: 20px;">Edit Name</button>
</div>

<!-- Modal for Editing Name -->
<div id="editNameModal" class="modal">
<div class="modal-content">
  <span class="close">&times;</span>
  <h2>Edit Your Name</h2>
  <form action="/profile/edit_name" method="POST" class="edit-name-form">
      <label for="new_name">New Name</label>
      <input type="text" id="new_name" name="new_name" placeholder="Enter new name" required>
      <button type="submit">Save Changes</button>
  </form>
</div>
</div>

{% endblock %}

<script>
var modal = document.getElementById("editNameModal");
var btn = document.getElementById("editNameBtn");
var span = document.getElementsByClassName("close")[0];

btn.onclick = function() {
  modal.style.display = "block";
}

span.onclick = function() {
  modal.style.display = "none";
}

window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}
</script>